



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.1">
    
    
      
        <title>Domain driven design for event based solution - Event Driven Architecture</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.982221ab.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    
      
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#starting-materials-generated-during-the-event-storming-workshop" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Event Driven Architecture" class="md-header-nav__button md-logo">
          
            <img src="../../images/cloud.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Event Driven Architecture
            </span>
            <span class="md-header-nav__topic">
              Domain driven design for event based solution
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/ibm-cloud-architecture/refarch-eda/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../.." title="Event Driven Architecture" class="md-nav__button md-logo">
      
        <img src="../../images/cloud.png" width="48" height="48">
      
    </a>
    Event Driven Architecture
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/ibm-cloud-architecture/refarch-eda/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../concepts/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      Architecture
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Architecture
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../architecture/" title="Reference diagrams" class="md-nav__link">
      Reference diagrams
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../evt-src/" title="Event sources" class="md-nav__link">
      Event sources
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../evt-backbone/" title="Event backbone" class="md-nav__link">
      Event backbone
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../evt-action/" title="Event actions" class="md-nav__link">
      Event actions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../evt-state/" title="Event managed states" class="md-nav__link">
      Event managed states
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/arch/" title="Event Stream & Kafka architecture" class="md-nav__link">
      Event Stream & Kafka architecture
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Methodology
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Methodology
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../readme/" title="Event driven methodology" class="md-nav__link">
      Event driven methodology
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../eventstorming/" title="Event Storming" class="md-nav__link">
      Event Storming
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc/analysis/readme/" title="Event Storming applied to container shipment analysis" class="md-nav__link">
      Event Storming applied to container shipment analysis
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Domain driven design for event based solution
      </label>
    
    <a href="./" title="Domain driven design for event based solution" class="md-nav__link md-nav__link--active">
      Domain driven design for event based solution
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#starting-materials-generated-during-the-event-storming-workshop" title="Starting materials generated during the Event Storming workshop" class="md-nav__link">
    Starting materials generated during the Event Storming workshop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps-in-the-design-process" title="Steps in the design process" class="md-nav__link">
    Steps in the design process
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-assess-domain-and-subdomains" title="Step 1: Assess domain and subdomains" class="md-nav__link">
    Step 1: Assess domain and subdomains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-defined-the-potential-application" title="Step 2: Defined the potential application" class="md-nav__link">
    Step 2: Defined the potential application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-define-the-ubiquitous-language" title="Step 3: Define the ubiquitous language" class="md-nav__link">
    Step 3: Define the ubiquitous language
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entities-and-value-objects" title="Entities and Value Objects" class="md-nav__link">
    Entities and Value Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregate-boundaries" title="Aggregate boundaries" class="md-nav__link">
    Aggregate boundaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounded-contexts" title="Bounded Contexts" class="md-nav__link">
    Bounded Contexts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories" title="Repositories" class="md-nav__link">
    Repositories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-linked-microservices-design-structure" title="Event linked microservices design - structure" class="md-nav__link">
    Event linked microservices design - structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-define-modules" title="Step 4: Define modules" class="md-nav__link">
    Step 4: Define modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-limit-the-context-and-scope-for-this-particular-build-sprint" title="Step 5: Limit the context and scope for this particular build / sprint" class="md-nav__link">
    Step 5: Limit the context and scope for this particular build / sprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-generate-microservice-interaction-diagrams-for-the-build" title="Step 6: Generate microservice interaction diagrams for the build" class="md-nav__link">
    Step 6: Generate microservice interaction diagrams for the build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-specify-recovery-approach-in-case-a-microservice-fails" title="Step 7: Specify recovery approach in case a microservice fails" class="md-nav__link">
    Step 7: Specify recovery approach in case a microservice fails
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concepts-and-rationale-underlying-the-design-approach" title="Concepts and rationale underlying the design approach" class="md-nav__link">
    Concepts and rationale underlying the design approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applied-ddd-for-the-reference-implementation" title="Applied DDD for the reference implementation" class="md-nav__link">
    Applied DDD for the reference implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Event driven design patterns
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Event driven design patterns
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../evt-microservices/" title="Microservices" class="md-nav__link">
      Microservices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../design-patterns/ED-patterns/" title="Event-driven patterns" class="md-nav__link">
      Event-driven patterns
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../design-patterns/event-sourcing/" title="Event Sourcing" class="md-nav__link">
      Event Sourcing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../design-patterns/cqrs/" title="CQRS" class="md-nav__link">
      CQRS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../design-patterns/saga/" title="Saga" class="md-nav__link">
      Saga
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-data-ai-analytics/data/data-replication/" title="Data replication pattern" class="md-nav__link">
      Data replication pattern
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Reference implementations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Reference implementations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc" title="Container shipment implementation solution" class="md-nav__link">
      Container shipment implementation solution
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Product guidances
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Product guidances
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/arch/" title="Kafka architecture" class="md-nav__link">
      Kafka architecture
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/readme/" title="Kafka concepts summary" class="md-nav__link">
      Kafka concepts summary
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/producers/" title="Kafka producer development practices" class="md-nav__link">
      Kafka producer development practices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/consumers/" title="Kafka consumer development practices" class="md-nav__link">
      Kafka consumer development practices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/kafka-stream/" title="Kafka streaming processing" class="md-nav__link">
      Kafka streaming processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/FAQ/" title="Kafka FAQ" class="md-nav__link">
      Kafka FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-kc/avro/avro" title="Adopting Avro with Kafka" class="md-nav__link">
      Adopting Avro with Kafka
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../kafka/monitoring/" title="Kafka monitoring" class="md-nav__link">
      Kafka monitoring
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../serverless/" title="Serverless" class="md-nav__link">
      Serverless
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Deployments
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Deployments
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/eventstreams/es-ibm-cloud/" title="Event Streams IBM CLOUD deployment" class="md-nav__link">
      Event Streams IBM CLOUD deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/eventstreams/" title="Event Streams Cloud Pak Integration deployment" class="md-nav__link">
      Event Streams Cloud Pak Integration deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/kafka/" title="Kafka deployment" class="md-nav__link">
      Kafka deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/zookeeper/" title="Zookeeper deployment" class="md-nav__link">
      Zookeeper deployment
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/postgresql/" title="Postgresql" class="md-nav__link">
      Postgresql
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/eventstreams/Install_Ceph_on_ICP/" title="Ceph deployment on ICP" class="md-nav__link">
      Ceph deployment on ICP
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../deployments/strimzi/deploy/" title="Kafka deployment with Strimzi" class="md-nav__link">
      Kafka deployment with Strimzi
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://github.com/ibm-cloud-architecture/refarch-integration/blob/master/docs/icp/troubleshooting.md" title="Troubleshouting" class="md-nav__link">
      Troubleshouting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Real time analytics
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Real time analytics
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../rt-analytics/" title="Concepts" class="md-nav__link">
      Concepts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="https://ibm-cloud-architecture.github.io/refarch-reefer-ml" title="Reefer Container Predictive Maintenance" class="md-nav__link">
      Reefer Container Predictive Maintenance
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../training/eda-skill-journey/" title="Skill journey" class="md-nav__link">
      Skill journey
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../compendium/" title="Compendium" class="md-nav__link">
      Compendium
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#starting-materials-generated-during-the-event-storming-workshop" title="Starting materials generated during the Event Storming workshop" class="md-nav__link">
    Starting materials generated during the Event Storming workshop
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#steps-in-the-design-process" title="Steps in the design process" class="md-nav__link">
    Steps in the design process
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-assess-domain-and-subdomains" title="Step 1: Assess domain and subdomains" class="md-nav__link">
    Step 1: Assess domain and subdomains
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-defined-the-potential-application" title="Step 2: Defined the potential application" class="md-nav__link">
    Step 2: Defined the potential application
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-define-the-ubiquitous-language" title="Step 3: Define the ubiquitous language" class="md-nav__link">
    Step 3: Define the ubiquitous language
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#entities-and-value-objects" title="Entities and Value Objects" class="md-nav__link">
    Entities and Value Objects
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aggregate-boundaries" title="Aggregate boundaries" class="md-nav__link">
    Aggregate boundaries
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bounded-contexts" title="Bounded Contexts" class="md-nav__link">
    Bounded Contexts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repositories" title="Repositories" class="md-nav__link">
    Repositories
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-linked-microservices-design-structure" title="Event linked microservices design - structure" class="md-nav__link">
    Event linked microservices design - structure
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-define-modules" title="Step 4: Define modules" class="md-nav__link">
    Step 4: Define modules
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-limit-the-context-and-scope-for-this-particular-build-sprint" title="Step 5: Limit the context and scope for this particular build / sprint" class="md-nav__link">
    Step 5: Limit the context and scope for this particular build / sprint
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-generate-microservice-interaction-diagrams-for-the-build" title="Step 6: Generate microservice interaction diagrams for the build" class="md-nav__link">
    Step 6: Generate microservice interaction diagrams for the build
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-specify-recovery-approach-in-case-a-microservice-fails" title="Step 7: Specify recovery approach in case a microservice fails" class="md-nav__link">
    Step 7: Specify recovery approach in case a microservice fails
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concepts-and-rationale-underlying-the-design-approach" title="Concepts and rationale underlying the design approach" class="md-nav__link">
    Concepts and rationale underlying the design approach
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#applied-ddd-for-the-reference-implementation" title="Applied DDD for the reference implementation" class="md-nav__link">
    Applied DDD for the reference implementation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/ibm-cloud-architecture/refarch-eda/edit/master/docs/methodology/ddd.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                  <h1>Domain driven design for event based solution</h1>
                
                <p>This section describes how to apply domain driven design with event based application and describe the high level steps which uses output from the event storming session and derives a set of micro services design specifications.</p>
<p><a href="../eventstorming/">Event storming</a> is part of the domain driven design methodology. And domain-driven design was deeply describe in <a href="https://www.amazon.com/Domain-Driven-Design-Tackling-Complexity-Software/dp/0321125215/ref=asc_df_0321125215/?tag=hyprod-20&amp;linkCode=df0&amp;hvadid=312118197030&amp;hvpos=1o1&amp;hvnetw=g&amp;hvrand=3363692763187919455&amp;hvpone=&amp;hvptwo=&amp;hvqmt=&amp;hvdev=c&amp;hvdvcmdl=&amp;hvlocint=&amp;hvlocphy=9032152&amp;hvtargid=pla-449269547899&amp;psc=1">Eric Evans's "Domain Driven Design: Tackling Complexity in the Heart of Software" book</a> from 2004. At IBM we also summarized the concepts needed for implementing microservice in <a href="https://www.ibm.com/cloud/garage/practices/code/domain-driven-design/overview">Kyle Brown's article</a>. </p>
<p>The goals for the design step are: </p>
<ul>
<li>To support highly modular cloud native microservices. </li>
<li>To adopt event coupled microservices - facilitating independent modification and evolution of each microservice separately.</li>
<li>To allow applying event-driven patterns such as event sourcing, CQRS and SAGA to address some of the challenges of microservice implementation: data consitency, transaction cross domain, and complex queries between aggregates managed by different services.</li>
</ul>
<h2 id="starting-materials-generated-during-the-event-storming-workshop">Starting materials generated during the Event Storming workshop</h2>
<p>We make use of the following materials generated during Event Storming and analysis workshop: </p>
<ul>
<li>Event Sequence flow.</li>
<li>Events – business description.</li>
<li>Critical events. </li>
<li>Aggregates and services:   <ul>
<li>Users – role based user stories.   </li>
<li>Commands.</li>
<li>Event linkages.</li>
<li>Policies. </li>
<li>Event prediction and probability flows. </li>
</ul>
</li>
</ul>
<p>The derivation of these material was described in: <a href="../eventstorming/">the event storming introduction</a>.</p>
<p>Here is an example of starting material illustrating the beginning of the process for the Reefer shipping business process:</p>
<p><img alt="" src="../images/event-storming-order.png" /></p>
<p>From there we complement the analysis and start the domain design.</p>
<h2 id="steps-in-the-design-process">Steps in the design process</h2>
<h3 id="step-1-assess-domain-and-subdomains">Step 1: Assess domain and subdomains</h3>
<p>Domain is what an organization does, and it includes the how to perform its operations.  It is composed of sub domains. A Core Domain is a part of the business Domain that is of primary importance to the success of the organization, the organization needs to excel at it.</p>
<p>During the event storming analysis, you define the domain and groups a set of subdomains like orders, invoice, customer, ... and external systems. Here is an example of such domain and subdomains:</p>
<p><img alt="" src="../images/domain-subdomains.png" /></p>
<p>We have three core subdomains and the rest are supports.</p>
<hr />
<h3 id="step-2-defined-the-potential-application">Step 2: Defined the potential application</h3>
<p>At the high level, when doing the analysis, you should have some insight decision of the top level application to develop, but it is also important to also list other systems to interact with. A classic system context diagram is a nice tool to represent that. The EDA reference implementation solution includes such <a href="https://ibm-cloud-architecture.github.io/refarch-kc/design/architecture/#system-context">system context diagram</a>.</p>
<p>Each interface needs to be documented using an efficient tools of <a href="https://www.ibm.com/developerworks/websphere/techjournal/1201_clark/1201_clark.html">interface characteristics</a>. </p>
<p>full set of interface characteristics is shown below:</p>
<ul>
<li>
<p>FUNCTIONAL DEFINITION</p>
<ul>
<li>Principal data objects</li>
<li>Operation/function</li>
<li>Read or change</li>
<li>Request/response objects</li>
</ul>
</li>
<li>
<p>TECHNICAL INTERFACE</p>
<ul>
<li>Transport</li>
<li>Protocol</li>
<li>Data format</li>
</ul>
</li>
<li>
<p>INTERACTION TYPE</p>
<ul>
<li>Request-response or fire-forget</li>
<li>Thread-blocking or asynchronous</li>
<li>Batch or individual</li>
<li>Message size</li>
</ul>
</li>
<li>
<p>PERFORMANCE</p>
<ul>
<li>Response times</li>
<li>Throughput</li>
<li>Volumes</li>
<li>Concurrency</li>
</ul>
</li>
<li>
<p>INTEGRITY</p>
<ul>
<li>Validation</li>
<li>Transactionality</li>
<li>Statefulness</li>
<li>Event sequence</li>
<li>Idempotence</li>
</ul>
</li>
<li>
<p>SECURITY</p>
<ul>
<li>Identity/authentication</li>
<li>Authorization</li>
<li>Data ownership</li>
<li>Privacy</li>
</ul>
</li>
<li>
<p>RELIABILITY</p>
<ul>
<li>Availability</li>
<li>Delivery assurance</li>
</ul>
</li>
<li>
<p>ERROR HANDLING</p>
<ul>
<li>Error management capabilities</li>
<li>Known exception conditions</li>
<li>Unexpected error presentation</li>
</ul>
</li>
</ul>
<hr />
<h3 id="step-3-define-the-ubiquitous-language">Step 3: Define the ubiquitous language</h3>
<p>This is where the work from the event storming and the relation with the business experts should help. Domain experts use their jargon while technical team members have their own language tuned for discussing the domain in terms of design. The terminology of day-to-day discussions is disconnected from the terminology embedded in the code, so the ubiquitous language helps to allign knowledge with design elements, code and tests. (Think about EJB, JPA entity, all the JEE design jargon versus ShippingOrder, order provisioning, fullfillment... )</p>
<p>The vocabulary of that ubiquitous language includes the class names and prominent operation names. The language includes terms to discuss rules that have been made explicit in the model. Be sure to commit the team to exercising that language relentlessly in all communication within the business and in the code. Use the same language in diagrams, writing, and especially speech.</p>
<p>Play with the model as you talk about the system. Describe scenarios out loud using the elements and interactions of the model, combining concepts in ways allowed by the model. Find easier ways to say what you need to say, and then take those new ideas back down to the diagrams and code.</p>
<h4 id="entities-and-value-objects">Entities and Value Objects</h4>
<p>Entities are part of the ubiquitous language, and represent business concepts that can be uniquely identified by some atributes. They have a life cycle that is important to model.</p>
<p>Value Object also represent things in the domain but without identity, and they are frequently transient, created for an operation and then discarded.</p>
<p>Some time in a certain context a value object could become an entity. As an example, an Address will be most of the time a value object, excepts in a mapping app or in an agenda app.</p>
<p>Below is an example of entities (Customer and Shipping Order) and value objects (delivery history and delivery specification):</p>
<p><img alt="" src="../images/ent-vo.png" /></p>
<h4 id="aggregate-boundaries">Aggregate boundaries</h4>
<p>An aggregate is a cluster of associated objects that we treat as a unit for the purpose of data changes. An entity is most likely and aggregate and every things related to it define its boundaries. </p>
<h4 id="bounded-contexts">Bounded Contexts</h4>
<p>Bounded Context explicitly defines the boundaries of your model. This concept is critical in large software projects. A Bounded Context sets the limits around what a specific team works on and helps them to define their own vocabulary within that particular context. When you define a bounded context, you define who uses it, how they use it, where it applies within a larger application context, and what it consists of in terms of things like Swagger documentation and code repositories.</p>
<p>Within a business context every use of a given domain term, phrase, or sentence, <strong>the Ubiquitous Language</strong> inside the boundary has a specific contextual meaning. So order context is a boundary context and groups order, ordered product type, pickup and shipping addresses, delivery specifications, delivery history. </p>
<h4 id="repositories">Repositories</h4>
<p>Repository represents the infrastructure service to persist the root aggregate during its full life cycle.
Client applications request objects from the repository using query methods that select objects based on criteria specified by the client, typically the value of certain attributes.</p>
<h4 id="event-linked-microservices-design-structure">Event linked microservices design - structure</h4>
<p>A complete event driven microservices specification (the target of this design step) includes specifications of the following: </p>
<ul>
<li>Event Topics <ul>
<li>Used to configure the Event Backbone </li>
<li>Mapped to the life cycle of the root entity</li>
<li>Topics can be chained to address different consumer semantic</li>
<li>Single partition for keeping order and support exactly once delivery</li>
</ul>
</li>
<li>Event types within each event topic </li>
<li>Microservices: <ul>
<li>They may be finer grained than aggregates or mapped to aggregate boundaries.</li>
<li>They may separate query and command; possibly multiple queries. </li>
<li>They could define demonstration control and serve main User Interface.</li>
<li>Reference the related Entities and value objects within each microservice.</li>
<li>Define APIs  ( Synchronous or asynchronous) using standards like openAPI. Could be done bottom up from the code, as most of TDD implementation will lead to. </li>
<li>Topics and events Subscribed to.</li>
<li>Events published / emitted.  </li>
</ul>
</li>
<li>List of end to end interactions:<ul>
<li>List of logic segments per microservice </li>
</ul>
</li>
<li>Recovery processing, scaling:<ul>
<li>We expect this to be highly patterned and template driven not requiring example-specific design. </li>
</ul>
</li>
</ul>
<hr />
<h3 id="step-4-define-modules">Step 4: Define modules</h3>
<ul>
<li>Each aggregate will be implemented as some composition of: <br />
    (1) a command microservice managing state changes to the entities in this aggregate<br />
    (2) possibly one or more separate (CQRS) query services providing internal or external API query capabilities <br />
    (3) additional simulation, predictive analytics or User Interface microservices   </li>
<li>The command microservice will be built around a collection of active entites for the aggregate, keyed by some primary key.</li>
<li>The separation of each aggregate into specific component microservices as outlined above, will be a complete list of microservices for the build / sprint. </li>
<li>Identify the data collections, and collection organization (keying structure) in each command and query microservice for this build.</li>
</ul>
<hr />
<h3 id="step-5-limit-the-context-and-scope-for-this-particular-build-sprint">Step 5: Limit the context and scope for this particular build / sprint</h3>
<p>We assume that we are developing a particular build for a sprint within some agile development approach, deferring additional functions and complexity to later sprints:</p>
<ul>
<li>Working from the initial list of aggregates, select which aggregates will be included in this build</li>
<li>For each aggregate the possible choices are:<ol>
<li>to completely skip and workaround the aggregate in this build.</li>
<li>to include a full lifecycle implementation of the aggregate   </li>
<li>to provide a simplified lifecycle implementation - typically a table of entities is initialized at start up, and state changes to existing entities are tracked   </li>
</ol>
</li>
<li>Determine whether there are simulation services or predictive analytics service to be included in the build </li>
<li>Identify the external query APIs and command APIs which this build should support </li>
<li>Create entity lifecycle diagrams for entites having a full lifecycle implementation in this build / sprint.</li>
</ul>
<hr />
<h3 id="step-6-generate-microservice-interaction-diagrams-for-the-build">Step 6: Generate microservice interaction diagrams for the build</h3>
<ul>
<li>The diagram will show API calls initiating state change. They should map the commands discovered during the event storming.</li>
<li>It shows for each interaction whether this is a synchronous API calls or an asynchronous event interaction via the event backbone.</li>
<li>The diagram labels each specific event interaction between microservices trigerring a state change.</li>
<li>Typically queries are synchronous API calls since the caller cannot usefully proceeed until a result is returned.</li>
<li>
<p>From these, we can extract:   </p>
<ol>
<li>a complete list of event types on each event backbone topic, with information passed on each event type.  </li>
<li>the complete list of “logic segments” for each microservice processing action in response to an API call or initiating event. </li>
</ol>
</li>
<li>
<p>When, at the next level of detail, the individual fields in each event are specified and typed, the <a href="https://github.com/cloudevents/spec">CloudEvents standard</a> may be used as a starting point.</p>
</li>
</ul>
<hr />
<h3 id="step-7-specify-recovery-approach-in-case-a-microservice-fails">Step 7: Specify recovery approach in case a microservice fails</h3>
<ul>
<li>If a microservice fails it will need to recover its internal state by reloading data from one or more topics, from the latest committed read.  </li>
<li>In general, command and query microservices will have a standard pattern for doing this.</li>
<li>Any custom event filtering and service specific logic should be specified.</li>
</ul>
<h3 id="concepts-and-rationale-underlying-the-design-approach">Concepts and rationale underlying the design approach</h3>
<p><em>What is the difference between event information stored in the event backbone and state data stored in the microservices?</em> </p>
<p>The event information stored persistently in the event backbone is organized by topic and, within each topic, entirely by event time-of-occurrence. While the state information in a microservice is a list (collection) of all <strong>currently active</strong> entities of the owning aggregate (e.g. all orders, all voyages etc) and the <strong>current</strong> state of each such entity. The entity records are keyed by primary key, like an OrderID.
While implementing microservice using event sourcing, CQRS, the persisted entity records are complementary to the historically organized information in the event backbone. </p>
<p><em>When is it acceptable to be using synchronous interactions between services instead of asynchronous event interacts through the event backbone?</em>   </p>
<p>For non-state-changing queries, for which the response is always instantaneously available a synchronous query call may be acceptable and will provide a simpler more understandable interface. Any processing which can be though of as being triggered by some state change in another aggregate should be modelled with an asynchronous event, because as the solution evolves other new microservices may also need to be aware of such event. We do not want to have to go back and change logic existing service where this event originated to have that microservice actively report the event to all potential consumers. </p>
<p><em>How do we save microservices from having to maintain data collections with complex secondary indexing for which eventual consistency will be hard to implement?</em></p>
<ul>
<li>Each command  microservice should do all its state changing updates using the primary key lookup only for its entities.</li>
<li>Each asynchronous event interaction between microservices should carry primary entityIds ( orderID, VoyageID, shipID) for any entities associated with the interaction.</li>
<li>Each query which might require speciaoized secondary indexing to respond to queries can be implemented in a separate CQRS query service which subscribes to events  to do all internal updating and receives events from the event backbone in a ( Consistent) eventually correct order. </li>
<li>This allows for recovery of any failed service by rebuilding it in "eventually correct" order.</li>
</ul>
<h3 id="applied-ddd-for-the-reference-implementation">Applied DDD for the reference implementation</h3>
<p>See <a href="https://ibm-cloud-architecture.github.io/refarch-kc-order-ms/ddd-applied/">this note for details.</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../eventstorming/" title="Event Storming" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Event Storming
              </span>
            </div>
          </a>
        
        
          <a href="../../evt-microservices/" title="Microservices" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Microservices
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.b806dc00.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
    
  </body>
</html>